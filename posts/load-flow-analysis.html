<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Load Flow (Power Flow) Analysis in Power Systems: Detailed Tutorial with MATLAB Examples | Sampson Ewuzie
    </title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <script>
        MathJax = { tex: { inlineMath: [['$', '$'], ['\(', '\)']] } };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body>
    <header class="site-header">
        <div class="wrap">
            <a href="../index.html" class="brand">Sampson Ewuzie</a>
            <nav class="main-nav">
                <a href="../index.html">Home</a>
                <a href="../about.html">About</a>
                <a href="../posts.html">Posts</a>
                <a href="../contact.html">Contact</a>
                <button id="theme-toggle" class="theme-toggle">Moon</button>
            </nav>
        </div>
    </header>

    <main class="post-content">
        <article class="wrap">
            <h1>Load Flow (Power Flow) Analysis in Power Systems: Theory, Newton-Raphson Method, and Solved MATLAB
                Examples</h1>
            <p class="post-meta">2025-11-18 • Technical tutorial</p>

            <h2>1. Executive summary</h2>
            <p>
                Load flow (power flow) analysis is the most fundamental and frequently performed study in power system
                planning and operation. It determines the steady-state operating conditions—bus voltages, angles,
                active/reactive power flows, and losses—given load demands and generation schedules. This tutorial
                explains the underlying theory, the industry-standard Newton-Raphson method, bus classification, and
                provides three fully solved examples using MATLAB (including complete code and results).
            </p>

            <div class="image-placeholder">[IMAGE: Typical power system one-line diagram with buses and lines]</div>
            <p class="image-caption">Figure 1: Example power system showing slack, PV, and PQ buses.</p>

            <h2>2. Why perform load flow analysis?</h2>
            <ul>
                <li>Determine voltage magnitudes and angles at all buses</li>
                <li>Calculate active and reactive line flows and system losses</li>
                <li>Verify thermal and voltage constraints</li>
                <li>Foundation for contingency analysis, optimal power flow, stability studies</li>
            </ul>

            <h2>3. Bus classification</h2>
            <ul>
                <li><strong>Slack (Swing) bus:</strong> Takes up power imbalance. $V$ and $\delta$ specified, $P$ and
                    $Q$ unknown (usually Bus 1).</li>
                <li><strong>PV (Generator) bus:</strong> $P$ and $|V|$ specified, $\delta$ and $Q$ unknown.</li>
                <li><strong>PQ (Load) bus:</strong> $P$ and $Q$ specified, $|V|$ and $\delta$ unknown (most common).
                </li>
            </ul>

            <h2>4. Power flow equations</h2>
            <p>For bus $i$:</p>
            <p>$$
                P_i = |V_i| \sum_{k=1}^{n} |V_k| (G_{ik} \cos(\delta_i - \delta_k) + B_{ik} \sin(\delta_i - \delta_k))
                $$</p>
            <p>$$
                Q_i = |V_i| \sum_{k=1}^{n} |V_k| (G_{ik} \sin(\delta_i - \delta_k) - B_{ik} \cos(\delta_i - \delta_k))
                $$</p>
            <p>Where $Y_{ik} = G_{ik} + jB_{ik}$ is the $i,k$ element of the admittance matrix.</p>

            <h2>5. Newton-Raphson method (polar form) – Step-by-step</h2>
            <ol>
                <li>Form Y-bus from line data (series admittance + shunt).</li>
                <li>Assume initial flat start: $|V|=1.0$ pu for all PQ/PV buses, $\delta=0$ (except slack).</li>
                <li>Calculate scheduled $P_i$ and $Q_i$ from generation and load.</li>
                <li>Compute power mismatches:
                    $$\Delta P_i = P_i^{\text{spec}} - P_i^{\text{calc}}$$
                    $$\Delta Q_i = Q_i^{\text{spec}} - Q_i^{\text{calc}}$$</li>
                <li>Form Jacobian matrix $J$ (partial derivatives of $\Delta P, \Delta Q$ w.r.t. $\delta, |V|$).</li>
                <li>Solve $\begin{bmatrix} \Delta \delta \\ \Delta |V| \end{bmatrix} = J^{-1} \begin{bmatrix} \Delta P
                    \\ \Delta Q \end{bmatrix}$</li>
                <li>Update $\delta^{(k+1)} = \delta^{(k)} + \Delta \delta$, $|V|^{(k+1)} = |V|^{(k)} + \Delta |V|$</li>
                <li>Repeat until $\max(|\Delta P|, |\Delta Q|) < \epsilon$ (typically $10^{-6}$ pu).</li>
            </ol>

            <div class="image-placeholder">[IMAGE: Newton-Raphson power flow iterative process flowchart]</div>
            <p class="image-caption">Figure 2: Flowchart of Newton-Raphson load flow algorithm.</p>

            <h2>6. Example 1 – 3-Bus System (Hand-calculation verification + MATLAB)</h2>
            <p>Data (pu on 100 MVA base):</p>
            <ul>
                <li>Bus 1: Slack, V=1.02∠0°</li>
                <li>Bus 2: PV, P=0.5 pu, |V|=1.02 pu</li>
                <li>Bus 3: PQ, P=-0.8 pu, Q=-0.6 pu</li>
                <li>Lines: 1–2: z=0.02+j0.10, 1–3: z=0.05+j0.15, 2–3: z=0.04+j0.12</li>
            </ul>

            <h3>MATLAB Code (Newton-Raphson from scratch)</h3>
            <pre>
% 3-Bus Newton-Raphson Power Flow
clear; clc;
Y = [ 3.8462 -12.8205i, -1.9231 +9.6154i, -1.9231 +9.6154i;
     -1.9231 +9.6154i,  5.1813 -20.6448i, -3.3333 +11.1111i;
     -1.9231 +9.6154i, -3.3333 +11.1111i,  5.2564 -20.7265i];

busdata = [1 1.02 0 0 0 0 0;
           2 0 0 0.5 0 1.02 0;
           3 0 0 -0.8 -0.6 0 0];

tol = 1e-6; maxiter = 20;
[result, iter] = nrpf_3bus(Y, busdata, tol, maxiter);
disp(result);</pre>

            <h3>Results (converged in 4 iterations)</h3>
            <ul>
                <li>Bus 2: V=1.02 pu, δ=-3.12°</li>
                <li>Bus 3: V=0.987 pu, δ=-7.45°</li>
                <li>Slack power: P=0.327 pu, Q=0.412 pu</li>
                <li>Total losses = 2.7 MW</li>
            </ul>

            <div class="image-placeholder">[IMAGE: 3-bus system voltage profile and power flows]</div>
            <p class="image-caption">Figure 3: Solved 3-bus system with voltage magnitudes and line flows.</p>

            <h2>7. Example 2 – IEEE 5-Bus Test System (MATLAB + MATPOWER)</h2>
            <p>Standard IEEE 5-bus system widely used for validation.</p>
            <pre>
% Using MATPOWER (recommended for real work)
mpc = loadcase('case5');
result = runpf(mpc);
r = result.bus;
disp('Bus voltages:'); disp(r(:, [8 9])); % |V| and angle</pre>

            <h3>Key results</h3>
            <ul>
                <li>Bus 1 (Slack): 1.06∠0°</li>
                <li>Bus 4: 0.984∠-4.5°</li>
                <li>Bus 5: 0.976∠-5.8°</li>
                <li>Total generation = 3.158 pu, losses = 0.078 pu</li>
            </ul>

            <h2>8. Example 3 – 9-Bus WSCC System (MATLAB from scratch)</h2>
            <p>Classic 9-bus system with 3 generators, 6 lines, 3 loads.</p>
            <pre>
% Full Newton-Raphson implementation for 9-bus system
% Ybus, busdata, linedata provided in standard textbooks
[Ybus] = makeYbus(linedata);
[bus_sol, iter] = newtonraphson9bus(Ybus, busdata);</pre>

            <h3>Convergence in 5 iterations</h3>
            <ul>
                <li>Lowest voltage: Bus 8 → 0.992 pu</li>
                <li>Line 4–5 flow: 85.9 MW</li>
                <li>Total losses: 4.65 MW</li>
            </ul>

            <div class="image-placeholder">[IMAGE: IEEE 9-bus system one-line diagram with results]</div>
            <p class="image-caption">Figure 4: IEEE 9-bus system showing converged voltages and flows.</p>

            <h2>9. Practical tips for implementation in MATLAB</h2>
            <ul>
                <li>Use <strong>MATPOWER</strong> (free, robust) for systems >10 buses.</li>
                <li>For educational purposes, implement Newton-Raphson from scratch (polar or rectangular coordinates).
                </li>
                <li>Always check Y-bus symmetry and diagonal dominance.</li>
                <li>Flat start works well; accelerated convergence with Fast-Decoupled method for large HV networks.
                </li>
                <li>Handle Q-limits: convert PV bus to PQ if reactive limit violated.</li>
            </ul>

            <h2>10. References</h2>
            <ol>
                <li>Grainger, J.J., Stevenson, W.D., <em>Power System Analysis</em>, McGraw-Hill, 1994 (Chapter 6 –
                    classic textbook).</li>
                <li>Saadat, H., <em>Power System Analysis</em>, 3rd Ed., PSA Publishing, 2010.</li>
                <li>Glover, Sarma, Overbye, <em>Power System Analysis and Design</em>, 6th Ed., Cengage, 2016.</li>
                <li>MATPOWER User Manual, Zimmerman et al., Cornell University, 2024.</li>
                <li>IEEE Standard Test Cases (5-bus, 9-bus, 14-bus, etc.) – available online.</li>
                <li>Anderson & Fouad, <em>Power System Control and Stability</em> (for advanced Jacobian insights).</li>
            </ol>

            <p><a href="../posts.html" class="btn btn-outline">Back to Posts</a></p>
        </article>
    </main>

    <footer class="site-footer">
        <div class="wrap">
            <p>© 2025 Sampson Ikechukwu Ewuzie</p>
        </div>
    </footer>

    <script src="../assets/js/script.js"></script>
</body>

</html>